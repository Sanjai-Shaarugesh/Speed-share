import{o as Be,i as F}from"./index-client.jTtPU0d8.js";import{p as W,c as Q,f as P,n as re,a as f,b as J,t as j,e as o,j as n,s as k,h as s,i as te,g as e,l as ae,r as i,m as Ee,o as Fe,k as be}from"./template.CA2CCGSC.js";import{d as Qe,e as ye}from"./events.C8s-YETX.js";import{I as ne,s as se,r as oe,C as ue,T as Ue,d as ve,e as xe,S as Ve,k as z,l as Ge,M as He,n as We,m as Je,o as Xe,q as Ye,t as ke,u as Ce,i as $e,E as Ze,f as fe,Q as et,g as tt,h as at,R as rt,j as nt,a as Me,v as De}from"./Toast.BD_N8rNA.js";import{d as Pe,w as st}from"./configs.CDK-naFb.js";import{s as ie}from"./snippet.BJi_jcpL.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./index.CbQUixJ7.js";import"./clsx.B-dksMZM.js";function ot(_,r){W(r,!0);let h=oe(r,["$$slots","$$events","$$legacy"]);ne(_,se({name:"antenna"},()=>h,{iconNode:[["path",{d:"M2 12 7 2"}],["path",{d:"m7 12 5-10"}],["path",{d:"m12 12 5-10"}],["path",{d:"m17 12 5-10"}],["path",{d:"M4.5 7h15"}],["path",{d:"M12 16v6"}]],children:(l,I)=>{var u=Q(),g=P(u);ie(g,()=>r.children??re),f(l,u)},$$slots:{default:!0}})),J()}function it(_,r){W(r,!0);let h=oe(r,["$$slots","$$events","$$legacy"]);ne(_,se({name:"circle-arrow-out-up-left"},()=>h,{iconNode:[["path",{d:"M2 8V2h6"}],["path",{d:"m2 2 10 10"}],["path",{d:"M12 2A10 10 0 1 1 2 12"}]],children:(l,I)=>{var u=Q(),g=P(u);ie(g,()=>r.children??re),f(l,u)},$$slots:{default:!0}})),J()}function dt(_,r){W(r,!0);let h=oe(r,["$$slots","$$events","$$legacy"]);ne(_,se({name:"copy"},()=>h,{iconNode:[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]],children:(l,I)=>{var u=Q(),g=P(u);ie(g,()=>r.children??re),f(l,u)},$$slots:{default:!0}})),J()}function lt(_,r){W(r,!0);let h=oe(r,["$$slots","$$events","$$legacy"]);ne(_,se({name:"cpu"},()=>h,{iconNode:[["path",{d:"M12 20v2"}],["path",{d:"M12 2v2"}],["path",{d:"M17 20v2"}],["path",{d:"M17 2v2"}],["path",{d:"M2 12h2"}],["path",{d:"M2 17h2"}],["path",{d:"M2 7h2"}],["path",{d:"M20 12h2"}],["path",{d:"M20 17h2"}],["path",{d:"M20 7h2"}],["path",{d:"M7 20v2"}],["path",{d:"M7 2v2"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1"}]],children:(l,I)=>{var u=Q(),g=P(u);ie(g,()=>r.children??re),f(l,u)},$$slots:{default:!0}})),J()}function ct(){window.location.href=`${window.location.origin}/`}var pt=j('<span class="mx-1 sm:mx-2 opacity-60 select-none text-sm sm:text-base md:text-lg">‒</span>'),ut=j('<div class="flex items-center"><input maxlength="1" class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 text-center text-sm sm:text-base md:text-xl border rounded-md shadow-sm transition-colors duration-200 input input-bordered focus:input-primary disabled:input-disabled"> <!></div>'),vt=(_,r)=>n(r,!e(r)),ft=(_,r)=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),n(r,!e(r)))},ht=Ee('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.724 7.732 5 12 5c4.268 0 8.268 2.724 9.542 7-1.274 4.276-5.274 7-9.542 7-4.268 0-8.268-2.724-9.542-7z"></path></svg>'),mt=Ee('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M17.94 17.94A10.944 10.944 0 0 1 12 19c-4.418 0-8.268-2.724-9.542-7a10.947 10.947 0 0 1 4.138-5.21"></path><path d="M1 1l22 22"></path><path d="M9.88 9.88a3 3 0 0 0 4.24 4.24"></path><path d="M21.54 12.53A10.944 10.944 0 0 0 12 5c-.706 0-1.394.07-2.053.203"></path></svg>'),_t=j("Process Offer <!>",1),gt=j('<p>Enter the offer code provided by your peer to establish a connection. See <a class="link" target="_blank" rel="noopener noreferrer">How does it work?</a></p> <div class="mt-4 flex items-center justify-center gap-2 relative"><!> <button type="button" class="absolute top-1/2 right-1 sm:right-2 transform -translate-y-1/2 p-1 sm:p-1.5 rounded-md transition-colors duration-200 hover:bg-gray-100 focus:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-200 active:bg-gray-200 dark:hover:bg-gray-700 dark:focus:bg-gray-700 dark:focus:ring-blue-800 dark:active:bg-gray-600 touch-manipulation" aria-label="Toggle offer code visibility"><!></button></div> <div class="mt-4 flex gap-2"><button class="btn btn-outline btn-accent"><!></button> <!></div> <div class="mt-4 flex gap-2"><a href="/" data-navigo=""><button class="btn btn-dash btn-warning">Go to Offer Page <!></button></a></div>',1),wt=j('<span class="mx-1 sm:mx-2 opacity-60 select-none text-sm sm:text-base md:text-lg">‒</span>'),bt=j('<div class="flex items-center"><input maxlength="1" class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 text-center text-sm sm:text-base md:text-xl border rounded-md shadow-sm transition-colors duration-200 input input-bordered focus:input-primary"> <!></div>'),yt=j('<p>Share this answer code with your peer to complete the connection.</p> <div class="relative mt-4 flex items-center justify-center gap-2"><!> <div class="absolute top-0 right-0 p-0.5 sm:p-1"><!></div></div> <div class="mt-4 flex gap-2"><button class="btn btn-soft btn-info gap-2">Copy Answer <!></button> <!></div>',1),xt=(_,r)=>{n(r,!0)},kt=(_,r,h)=>{n(r,!1),n(h,!1)},Ct=j('<div class="flex w-full mb-4 mt-2 justify-center"><div class="join w-full"><button class="btn btn-dash btn-warning join-item w-1/2 text-xl py-4 min-h-[3.5rem] inline-flex items-center justify-center gap-x-2"><!> <span class="btm-nav-label">Send</span></button> <div class="indicator w-1/2 join-item relative"><span style="top: 0; right: 10%; left: 70%; z-index: 10;">New files</span> <button class="btn btn-dash btn-secondary join-item w-full text-xl py-4 min-h-[3.5rem] inline-flex items-center justify-center gap-x-2"><!> <span class="btm-nav-label">Receive</span></button></div></div></div> <div><!></div> <div><!></div>',1),$t=j('<div class="container mx-auto p-4 max-w-3xl"><h1 class="text-2xl font-bold mb-4">File Transfer - Answer Page</h1> <!> <!> <!> <!></div>');function Ot(_,r){W(r,!0);let h=k(""),$=k(!1),l=k(""),I=k(!1),u=k(!1),g=k(void 0),U=k(void 0),he=k(void 0),q=k(void 0),X=k(void 0),Y=k(!1),de=k(!1),le=k(void 0),M;async function Z(){if(!e(h)){z("Please enter an offer code","error");return}n($,!0);try{const{sdp:a,iceServer:v,chunkSize:t,publicKey:c}=Ge(e(h));M=new RTCPeerConnection({iceServers:[{urls:v||Pe.iceServer}]}),M.ondatachannel=D=>{n(g,D.channel,!0),e(g).onopen=()=>{z("Connected","success"),n(u,!0),e(le)?.close()},e(g).onmessage=x=>{const m=He.decode(new Uint8Array(x.data));m.metaData!==void 0&&e(q)?(e(q).onMetaData(m.id,m.metaData),n(de,!0)):m.chunk!==void 0&&e(q)?e(q).onChunkData(m.id,m.chunk):m.receiveEvent!==void 0&&e(X)&&e(X).onReceiveEvent(m.id,m.receiveEvent)},e(g).onerror=()=>{z("WebRTC error","error"),n(u,!1)},e(g).onclose=()=>{z("Disconnected","error"),n(u,!1)}};const b={type:"offer",sdp:We(a,!0)};await M.setRemoteDescription(b);const w=!!c;w&&n(he,await Je(c),!0),await Se(w,t)}catch(a){console.error("Error processing offer:",a),z("Invalid offer code","error"),n($,!1)}}async function Se(a,v){let t="";a&&(n(U,await Xe(),!0),t=await Ye(e(U).publicKey)),M.onicecandidate=b=>{if(!b.candidate&&M.localDescription){const w=ke(M.localDescription.sdp);n(l,Ce(w,{publicKey:t}),!0),n($,!1)}};const c=await M.createAnswer();await M.setLocalDescription(c),setTimeout(async()=>{if(!M.localDescription||e(l))return;z("Timeout waiting ICE candidates");const b=ke(M.localDescription.sdp);n(l,Ce(b,{publicKey:t}),!0),n($,!1)},st)}async function me(){await navigator.clipboard.writeText(e(l)),z("Copied to clipboard","info")}function Ae(a){n(h,a,!0),Z()}let ee=k(!1);function je(a,v){const t=v.target.value.slice(-1);n(h,e(h).padEnd(5," ").split("").map((c,b)=>b===a?t:c).join(""),!0)}function Te(a){const v=a.clipboardData?.getData("text")?.trim().slice(0,5)??"";v&&(a.preventDefault(),n(h,v.padEnd(5," "),!0))}function Ke(a,v){const t=v.target.value.slice(-1);n(l,e(l).padEnd(5," ").split("").map((c,b)=>b===a?t:c).join(""),!0)}function Oe(a){const v=a.clipboardData?.getData("text")?.trim().slice(0,5)??"";v&&(a.preventDefault(),n(l,v.padEnd(5," "),!0))}Be(()=>{let a=!1;const v=t=>{if(t.key.toLowerCase()==="g"?a=!0:(a&&t.key.toLowerCase()==="o"&&(t.preventDefault(),window.location.href="/"),a=!1),t.key==="Enter")t.preventDefault(),Z();else if(t.altKey&&t.key.toLowerCase()==="p")t.preventDefault(),Z();else if((t.ctrlKey||t.metaKey)&&t.key.toLowerCase()==="v"){const c=document.querySelector('input[type="password"]');c&&c.focus()}else t.ctrlKey&&t.key.toLowerCase()==="c"&&(t.preventDefault(),me())};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)});var ce=$t(),_e=s(o(ce),2);const Re=ae(()=>!e(l)&&!e(u));ue(_e,{title:"1. Enter Offer Code",get isOpen(){return e(Re)},children:(a,v)=>{var t=gt(),c=P(t),b=s(o(c));ve(b,"href","https://speed-share-web.vercel.app/#how-does-it-work"),i(c);var w=s(c,2),D=o(w);xe(D,16,()=>Array(5),$e,(p,d,N)=>{var pe=ut(),L=o(pe);Me(L),L.__input=H=>je(N,H);var ze=s(L,2);{var Ie=H=>{var qe=pt();f(H,qe)};F(ze,H=>{N<4&&H(Ie)})}i(pe),te(()=>{ve(L,"type",e(ee)?"text":"password"),De(L,e(h)[N]||""),L.disabled=e($)}),ye("paste",L,Te),f(p,pe)});var x=s(D,2);x.__click=[vt,ee],x.__keydown=[ft,ee];var m=o(x);{var E=p=>{var d=ht();f(p,d)},V=p=>{var d=mt();f(p,d)};F(m,p=>{e(ee)?p(E):p(V,!1)})}i(x),i(w);var S=s(w,2),C=o(S);C.__click=Z;var B=o(C);{var O=p=>{var d=Fe("Processing");f(p,d)},A=p=>{var d=_t(),N=s(P(d));lt(N,{}),f(p,d)};F(B,p=>{e($)?p(O):p(A,!1)})}i(C);var R=s(C,2);Ve(R,{onScanSuccess:Ae}),i(S);var T=s(S,2),K=o(T),y=o(K);y.__click=[ct];var G=s(o(y));it(G,{}),i(y),i(K),i(T),te(()=>C.disabled=e($)),f(a,t)},$$slots:{default:!0}});var ge=s(_e,2);const Ne=ae(()=>e(l)!==""&&!e(u));ue(ge,{title:"2. Share Answer Code",get isOpen(){return e(Ne)},children:(a,v)=>{var t=Q(),c=P(t);{var b=w=>{var D=yt(),x=s(P(D),2),m=o(x);xe(m,16,()=>Array(5),$e,(A,R,T)=>{var K=bt(),y=o(K);Me(y),y.__input=d=>Ke(T,d),y.readOnly=!1;var G=s(y,2);{var p=d=>{var N=wt();f(d,N)};F(G,d=>{T<4&&d(p)})}i(K),te(()=>{ve(y,"type",e(I)?"text":"password"),De(y,e(l)[T]||"")}),ye("paste",y,Oe),f(A,K)});var E=s(m,2),V=o(E);Ze(V,{onChange:A=>{n(I,A,!0)}}),i(E),i(x);var S=s(x,2),C=o(S);C.__click=me;var B=s(o(C));dt(B,{}),i(C);var O=s(C,2);fe(et(O,{get qrData(){return e(l)},title:"Answer QR Code"}),A=>n(le,A,!0),()=>e(le)),i(S),f(w,D)};F(c,w=>{e(l)&&w(b)})}f(a,t)},$$slots:{default:!0}});var we=s(ge,2);ue(we,{title:"3. Transfer Files",get isOpen(){return e(u)},children:(a,v)=>{var t=Q(),c=P(t);{var b=w=>{var D=Ct(),x=P(D),m=o(x),E=o(m);E.__click=[xt,Y];var V=o(E);tt(V,{}),be(2),i(E);var S=s(E,2),C=o(S);let B;var O=s(C,2);O.__click=[kt,de,Y];var A=o(O);ot(A,{}),be(2),i(O),i(S),i(m),i(x);var R=s(x,2),T=o(R);const K=ae(()=>!!e(U));fe(at(T,{get dataChannel(){return e(g)},get rsaPub(){return e(he)},get isEncrypt(){return e(K)},get chunkSize(){return Pe.chunkSize}}),d=>n(X,d,!0),()=>e(X)),i(R);var y=s(R,2),G=o(y);const p=ae(()=>!!e(U));fe(rt(G,{get dataChannel(){return e(g)},get isEncrypt(){return e(p)},get rsa(){return e(U)}}),d=>n(q,d,!0),()=>e(q)),i(y),te(d=>{B=nt(C,1,"indicator-item badge badge-success text-xs animate-bounce",null,B,d),R.hidden=!e(Y),y.hidden=e(Y)},[()=>({hidden:!e(de)})]),f(w,D)};F(c,w=>{e(g)&&w(b)})}f(a,t)},$$slots:{default:!0}});var Le=s(we,2);Ue(Le,{}),i(ce),f(_,ce),J()}Qe(["input","click","keydown"]);export{Ot as default};
